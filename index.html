<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Evolution Simulator</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="app">
      <!-- Main simulation area -->
      <div id="simulation-container">
        <canvas id="worldCanvas"></canvas>
        <!-- Overlay for creature labels or selection indicator -->
        <canvas id="overlayCanvas"></canvas>
      </div>
      <!-- Side panel with brain graph and stats -->
      <div id="sidePanel">
        <div id="stats">
          <h2>Population Stats</h2>
          <div><strong>Generation:</strong> <span id="generation">0</span></div>
          <div><strong>Step:</strong> <span id="step">0</span>/<span id="generationLength">0</span></div>
          <!--
            The term "Average Fitness" previously referred to the average
            eastward position of the population.  Since the simulator
            now measures how many creatures finish a generation in
            reproduction‑allowed zones, we re‑label this metric to
            "Survival Rate".  It represents the fraction of the
            population that ends a generation in a green zone and is
            therefore eligible to reproduce.
          -->
          <div><strong>Survival Rate:</strong> <span id="avgFitness">0</span></div>
          <div><strong>Mutation Rate:</strong> <span id="mutationRateLabel">0</span></div>
          <input type="range" id="mutationRateSlider" min="0" max="0.5" step="0.01" value="0.05" />
          <div class="control-buttons">
            <button id="toggleZonesBtn" title="Toggle zone editing">Edit Zones</button>
            <button id="toggleDarkBtn" title="Toggle dark mode">Dark Mode</button>
            <button id="skipGenBtn" title="Skip one generation">Skip Gen</button>
          </div>
          <div class="speed-control">
            <label for="speedSlider"><strong>Speed:</strong> <span id="speedLabel">1x</span></label>
            <input type="range" id="speedSlider" min="1" max="10" step="1" value="1" />
          </div>
          <p class="zone-legend"><span class="green-box"></span> reproduce allowed &nbsp; <span class="red-box"></span> reproduce blocked</p>
        </div>
        <hr />
        <div id="brainPanel">
          <h2>Brain Graph</h2>
          <svg id="brainGraph" width="360" height="360"></svg>
        </div>
      </div>
    </div>
    <!-- Bottom chart area -->
    <div id="chartContainer">
      <canvas id="chartCanvas"></canvas>
    </div>
    <!-- Load external libraries from CDN for d3 and p5 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
    <script src="main.js"></script>
  </body>
</html>
